# オフィス スクリプト入門(PHP&GAS ~Fakerを添えて~)

Googleスプレッドシートに対してPHPとGASを利用して書き込みを行います。

プログラム内で正規表現、SQLを使用してみます。

[1.Fakerを用いた擬似データ作成](%E3%82%AA%E3%83%95%E3%82%A3%E3%82%B9%20%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%95%E3%82%9A%E3%83%88%E5%85%A5%E9%96%80(PHP&GAS%20~Faker%E3%82%92%E6%B7%BB%E3%81%88%E3%81%A6~)%20f47ea356945c4a548c0cc8fe14385b87/1%20Faker%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E6%93%AC%E4%BC%BC%E3%83%86%E3%82%99%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90%20b766baca56034008ba830b4879d3a0e2.md)

[2.PHPからスプレッドシートへの書き込み](%E3%82%AA%E3%83%95%E3%82%A3%E3%82%B9%20%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%95%E3%82%9A%E3%83%88%E5%85%A5%E9%96%80(PHP&GAS%20~Faker%E3%82%92%E6%B7%BB%E3%81%88%E3%81%A6~)%20f47ea356945c4a548c0cc8fe14385b87/2%20PHP%E3%81%8B%E3%82%89%E3%82%B9%E3%83%95%E3%82%9A%E3%83%AC%E3%83%83%E3%83%88%E3%82%99%E3%82%B7%E3%83%BC%E3%83%88%E3%81%B8%E3%81%AE%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%20096ea92ecd0940b69a2fa8944549190a.md)

## PHPで正規表現

マッチした場合に1を返します。

if文に入れればマッチした場合だけ処理などが可能です。

```
preg_match("/^a.*x$/", $fname)
```

## スプレッドシートで問い合わせ

SQLに似た構文のQuery文というものがスプレッドシートでは使用できます。

```sql
=QUERY(A:B,"select A where B >50",-1)
```